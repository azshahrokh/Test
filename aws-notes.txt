associate security groups with ec2 instances
aws ec2 describe-instances --output text --query 'Reservations[*].Instances[*].[InstanceId,SecurityGroups[].GroupName | join(`, `, @),Placement.AvailabilityZone,BlockDeviceMappings[].DeviceName | join(`, `, @), BlockDeviceMappings[].Ebs.DeleteOnTermination | join(`, `, to_array(to_string(@)))]' | sed 's/\t/,/g' > ec2_w_secgroups.csv


list all security groups
aws ec2 describe-security-groups --query 'SecurityGroups[*].{Name:GroupName, Id:GroupId, Vpc:VpcId}' --output text | sed 's/\t/,/g' > aws_secgroups.csv


list of all ec2 instances
aws ec2 describe-instances --query "Reservations[*].Instances[*].{Id:InstanceId,Name:Tags[?Key=='Name']|[0].Value}" --output text | sed 's/\t/,/g' > all_ec2.csv
